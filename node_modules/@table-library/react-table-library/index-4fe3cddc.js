import{s as n}from"./slicedToArray-c92cae3a.js";import{t as e}from"./toConsumableArray-25e5c43c.js";import{d as r}from"./defineProperty-9f9de5d0.js";import*as t from"react";import{a as o,f as i}from"./fromTreeToList-3cbd0e99.js";import{u as a,a as u}from"./useSyncControlledState-80c86a40.js";var c=function(n,e){return n.every((function(n){return e.includes(n)}))};function d(n,e){var r=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);e&&(t=t.filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.push.apply(r,t)}return r}function l(n){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?d(Object(t),!0).forEach((function(e){r(n,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))}))}return n}var s=function(n,r){switch(r.type){case"ADD_BY_ID":return function(n,e){return l(l({},n),{},{id:null,ids:n.ids.concat(e.payload.id)})}(n,r);case"REMOVE_BY_ID":return function(n,e){return l(l({},n),{},{id:null,ids:n.ids.filter((function(n){return n!==e.payload.id}))})}(n,r);case"ADD_BY_IDS":return function(n,r){var t=r.payload.options.isCarryForward&&null!=n.id?e(Array.from(new Set(r.payload.ids.concat(n.id)))):n.ids.concat(r.payload.ids);return l(l({},n),{},{id:null,ids:t})}(n,r);case"REMOVE_BY_IDS":return function(n,e){return l(l({},n),{},{id:null,ids:n.ids.filter((function(n){return!e.payload.ids.includes(n)}))})}(n,r);case"ADD_BY_ID_EXCLUSIVELY":return function(n,e){return l(l({},n),{},{id:e.payload.id,ids:[]})}(n,r);case"REMOVE_BY_ID_EXCLUSIVELY":case"REMOVE_ALL":return function(n){return l(l({},n),{},{id:null,ids:[]})}(n);case"ADD_ALL":return function(n,r){return l(l({},n),{},{id:null,ids:e(Array.from(new Set([].concat(e(n.ids),e(r.payload.ids)))))})}(n,r);case"SET":return function(n,e){return l(l({},n),e.payload)}(n,r);default:throw new Error}},f={isCarryForward:!0,isPartialToAll:!1},y=function(n){return l(l({},f),n)},p=function(n,r){var t=i(r,n);return[t].concat(e(o(null==t?void 0:t.nodes))).map((function(n){return n.id}))},I=function(e,r,i,d){var f=a(s,r,[],[i],d),I=n(f,2),v=I[0],D=I[1],E=t.useRef({lastToggledId:null,currentShiftIds:[]}),_=!v.ids.length,b=!!e.nodes.length&&c(e.nodes.map((function(n){return n.id})),v.ids),g=t.useCallback((function(n){return D({type:"ADD_BY_ID",payload:{id:n}})}),[D]),m=t.useCallback((function(n){return D({type:"REMOVE_BY_ID",payload:{id:n}})}),[D]),A=t.useCallback((function(n){v.ids.includes(n)?m(n):g(n),E.current.lastToggledId=n,E.current.currentShiftIds=[]}),[v,g,m]),O=t.useCallback((function(n,e){var r=y(e);D({type:"ADD_BY_IDS",payload:{ids:n,options:r}})}),[D]),S=t.useCallback((function(n){D({type:"REMOVE_BY_IDS",payload:{ids:n}})}),[D]),B=t.useCallback((function(n,r){var t,o,i=y(r),a=p(n,e.nodes);i.isPartialToAll||(t=a,o=v.ids,t.every((function(n){return!o.includes(n)}))?O(a,i):S(a)),i.isPartialToAll&&(c(a,v.ids)?S(a):O(a,i)),E.current.lastToggledId=n,E.current.currentShiftIds=[]}),[e.nodes,v.ids,O,S]),C=t.useCallback((function(n,r){var t=y(r),o=p(n,e.nodes);O(o,t)}),[e.nodes,O]),T=t.useCallback((function(n){var r=p(n,e.nodes);S(r)}),[e.nodes,S]),h=t.useCallback((function(n){D({type:"ADD_BY_ID_EXCLUSIVELY",payload:{id:n}})}),[D]),L=t.useCallback((function(){D({type:"REMOVE_BY_ID_EXCLUSIVELY"})}),[D]),R=t.useCallback((function(n){n===v.id?L():h(n),E.current.lastToggledId=n,E.current.currentShiftIds=[]}),[v,L,h]),j=t.useCallback((function(n){D({type:"ADD_ALL",payload:{ids:n}})}),[D]),k=t.useCallback((function(){D({type:"REMOVE_ALL"})}),[D]),Y=t.useCallback((function(n){var r=y(n),t=o(e.nodes).map((function(n){return n.id}));r.isPartialToAll||(_?j(t):k()),r.isPartialToAll&&(b?k():j(t))}),[e.nodes,_,j,k,b]),P=t.useCallback((function(n,r,t){var o=y(r);E.current.currentShiftIds.length&&(S(E.current.currentShiftIds),E.current.currentShiftIds=[]);var i=E.current.lastToggledId,a=n,u=t(e.nodes).map((function(n){return n.id})),c=u.findIndex((function(n){return n===i})),d=u.findIndex((function(n){return n===a}));if(c>d){var l=[d,c];c=l[0],d=l[1]}var s=u.slice(c,d+1);O(s,o),E.current.currentShiftIds=s}),[e.nodes,O,S]);u(r,v,(function(){return D({type:"SET",payload:r})}));var w=t.useMemo((function(){return{onAddById:g,onRemoveById:m,onToggleById:A,onAddByIds:O,onRemoveByIds:S,onToggleByIdRecursively:B,onAddByIdRecursively:C,onRemoveByIdRecursively:T,onAddByIdExclusively:h,onRemoveByIdExclusively:L,onToggleByIdExclusively:R,onToggleByIdShift:P,onAddAll:j,onRemoveAll:k,onToggleAll:Y}}),[j,g,O,k,m,S,h,L,R,Y,A,B,P,C,T]);return[l(l({},v),{},{none:_,all:b}),w]};export{I as u};
//# sourceMappingURL=index-4fe3cddc.js.map
